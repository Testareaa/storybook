pipeline{
    environment{
        dockerimagename = "localhost:5000/storybook-showcase"
        dockerImage = ""
    }
    agent any

    stages {
        stage("Checkout SCM"){
            steps{
                checkout scm
            }
        }
        stage("Build Image"){
            steps{
                script{
                    dockerImage = docker.build dockerimagename                    
                }
            }
        }
        stage("Pushing Image"){
            steps{
                script{
                    docker.withRegistry("http://localhost:5000"){
                        dockerImage.push("latest")
                    }
                }
            }
        }
    }
}
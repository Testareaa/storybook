node{
    def dockerImage

    stages {
        stage("Checkout SCM"){
            git "https://github.com/Testareaa/storybook.git"
        }
        stage("Build Image"){
            dockerImage = docker.build("localhost:5000/storybook-showcase")                    
        }
        stage("Pushing Image"){
            steps{
                script{
                    docker.withRegistry("http://localhost:5000"){
                        dockerImage.push("${env.BUILD_NUMBER}")
                        dockerImage.push("latest")
                    }
                }
            }
        }
    }
}